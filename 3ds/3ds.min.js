var n = {
    pokemon_species: function (c) {
        h();
        k();
        $.get("/json/pokemon/" + c.id + ".json", function (l) {
            $.get("/json/pokemon_species/" + c.id + ".json", function (b) {
                var d = [],
                    a;
                for (a in sprite_versions) a = sprite_versions[a], Number(a.b) >= Number(b.b) && d.push(a.identifier);
                h();
                $(".hcontent").append("<h4>" + c.name + " - The " + c["csv"]["genus"] + " Pokemon</h4>");
                b = $("<button>Search</button>");
                $(".content").append(b);
                b.click(m);
                foreach(d, function (a) {
                    var b = mediaDir + "pokemon/main-sprites/" + a + "/" + l.id + ".png",
                        d = $("<div id='" + a + "'>" + a + ": </div><br>");
                    $(".content").append(d);
                    $.c({
                        url: b,
                        type: "HEAD",
                        error: function () {},
                        f: function () {
                            d.append("<img src='" + b + "' style='display:block;margin:0 auto;'/>")
                        }
                    })
                }, function () {})
            }, "json")["fail"](function () {
                alert("An error occured while downloading the pokemon data");
                m()
            })
        }, "json")["fail"](function () {
            alert("An error occured while downloading the pokemon data");
            m()
        })
    }
};
window.ui = n;
window.onerror = function (c) {
    alert("Error occured: " + c);
    return !1
};

function h() {
    $(".content").empty();
    $(".hcontent").empty();
    window.scrollTo(0, 215)
}
window.pageInit = h;

function k() {
    $(".content").append('<p style="float: right; position: relative; top:188px; margin: 0;">Loading...</p>')
}
window.loadScreen = k;

function m() {
	var b;
    function c(d, a) {
        null == b[a] && (b[a] = []);
        b[a].push(d)
    }

    function l(b) {
        return function () {
            if (null != n[b.type]) n[b.type](b);
            else alert("Cannot load a " + b.type)
        }
    }
    h();
    $(".content").append('<input id="search" type="text"/><button id="searchb">Search</button><div id="results"></div>');
    $("#searchb").click(function () {
        b = {};
        $("#results").empty();
		var d = (new Date).getTime(), a = $("#search").val().toLowerCase(), g = a.split(" "), p = queryKeys.length, u = queryKeys, v = queryData, w = g.length;
        for (;p--;) {
            var e = u[p],
                q = v[e];
            if (e.indexOf(a) >= 0) c(q, 1);
            else {
                for (var r = w, s = !1; r--;)
					var t = g[r], f = t.length;
                    while (f--) {
                        if (e.indexOf(t.substring(0, f)) >= 0) {
                            s = !0;
                            break
                        }
                        if (f < 4) break
                    }
                s && c(q, 0.5)
            }
        }
        alert("Search time: " + ((new Date).getTime() - d));
        (function (b) {
            var a = [],
                c;
            for (c in b) b.hasOwnProperty(c) && a.push(c);
            return a
        })(b).sort().reverse().forEach(function (a) {
            var c = b[a],
                d;
            for (d in c) {
                var e = c[d],
                    f;
                for (f in e)
                    if (a = e[f], null != a) {
                        var g = $("<button>" + a.type + ": " + a.name + "</button>");
                        g.click(l(a));
                        $("#results").append(g)
                    }
            }
        })
    })
}
window.searchPage = m;
$(function () {
    setTimeout(function () {
        window.scrollTo(0, 215);
        loadPP()
    }, 500)
});